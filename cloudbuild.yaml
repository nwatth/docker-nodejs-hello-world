steps:
  - name: 'gcr.io/cloud-builders/docker'
    id: 'docker-build'
    entrypoint: 'bash'
    args: ['-c', 'docker login --username=$_DOCKER_USERNAME --password=$_DOCKER_PASSWORD', '&&', 'docker build -t asia-southeast1-docker.pkg.dev/tqm-infra-sandbox-343707/docker-nodejs-hello-world .']

  - name: 'gcr.io/cloud-builders/docker'
    id: 'docker-push'
    entrypoint: 'bash'
    waitFor: ['docker-build']
    args: ['-c', 'docker login --username=$_DOCKER_USERNAME --password=$_DOCKER_PASSWORD', '&&', 'docker push asia-southeast1-docker.pkg.dev/tqm-infra-sandbox-343707/docker-nodejs-hello-world']

options:
  logging: CLOUD_LOGGING_ONLY

images: ['asia-southeast1-docker.pkg.dev/tqm-infra-sandbox-343707/docker-nodejs-hello-world']
